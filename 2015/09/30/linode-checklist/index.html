<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <title>Linode Checklist | TooNormal</title>
    
    <meta name="description" content="More notes. Sorry. 🙂">
    <meta name="author" content="Mike K">
    
    <link href="https://new.toonormal.com/an-old-hope.min.css" rel="stylesheet">
    <link href="https://new.toonormal.com/style.css" rel="stylesheet">
    <link href="https://new.toonormal.com/custom.css" rel="stylesheet">
    
    <link rel="apple-touch-icon" href="https://new.toonormal.com/apple-touch-icon.png">
    <link rel="icon" href="https://new.toonormal.com/favicon.ico">
    <meta name="generator" content="Hugo 0.74.1" />
    
    
    
    <script>
      function setTheme() {
      	

      }
    </script>
  </head>
  <body class="single">
    <script>
      setTheme();
    </script>
    <header class="header">
      <nav class="nav">
        <span class="logo">
        	<a href="https://new.toonormal.com/">TooNormal</a>
			<span class="subtitle"> - a note-blog by Mike Kasprzak</span>
        </span>
        <ul class="menu">
          <li>
            <a href="/about/">About</a>
          </li>
          <li>
            <a href="/blog/">Notes &amp; Blog</a>
          </li>
          <li>
            <a href="/recipes/">Recipes</a>
          </li>
          <li>
            <a href="https://twitter.com/mikekasprzak">Twitter</a>
          </li>
          <li>
            <a href="https://youtube.com/mikekasprzak">YouTube</a>
          </li>
        </ul>
      </nav>
    </header>
    <main class="main">


<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">Linode Checklist</h1>
    <div class="post-meta">Mike K · September 30, 2015
    </div>
  </header>
  <div class="post-content"><p>More notes. Sorry. 🙂</p>
<h2 id="1-hostname-and-timezone">1. Hostname and TimeZone</h2>
<p>Reference: <a href="https://www.linode.com/docs/getting-started">https://www.linode.com/docs/getting-started</a></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Add a line below localhost and ubnutu:</p>
<!-- raw HTML omitted -->
<p>To set timezone:</p>
<!-- raw HTML omitted -->
<p>UI should be straightforward. Use command <code>date</code> to confirm it’s correct.</p>
<h2 id="2-add-user">2. Add User</h2>
<p>Reference: <a href="https://www.linode.com/docs/security/securing-your-server/">https://www.linode.com/docs/security/securing-your-server/</a></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="3-firewall">3. Firewall</h2>
<p>Reference: <a href="https://www.linode.com/docs/security/firewalls/configure-firewall-with-ufw">https://www.linode.com/docs/security/firewalls/configure-firewall-with-ufw</a></p>
<p>Be sure to allow SSH <strong>before</strong> activating the firewall, if you happen to be SSH’ing in to it.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="4-fail2ban">4. Fail2Ban</h2>
<p>Reference: <a href="https://www.linode.com/docs/security/securing-your-server/#installing-and-configuring-fail2ban">https://www.linode.com/docs/security/securing-your-server/#installing-and-configuring-fail2ban</a></p>
<p>Fail2Ban adds IPTABLES entries for denying users that have triggered a ban. Thus, they will be denied access to the server for a period of time.</p>
<!-- raw HTML omitted -->
<p>By default, Fail2Ban is configured to watch/track SSH connection traffic. Fail2Ban can be configured for other services as well.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Fail2Ban plays nice with UFW (both tools manage the IPTABLES). UFW will only its own denied/allowed IPs, so the commands above are required for checking who is denied.</p>
<h2 id="5a-disable-root-login-via-ssh">5a. Disable Root Login via SSH</h2>
<!-- raw HTML omitted -->
<p>Made the following changes:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="5b-allow-ssh-only-from-lan">5b. Allow SSH only from LAN</h2>
<!-- raw HTML omitted -->
<p>Set the <code>ListenAddress</code> to the internal IP (not the public IP).</p>
<h2 id="5c-remove-ssh-server">5c. Remove SSH Server</h2>
<!-- raw HTML omitted -->
<h2 id="6a-install-mariadb">6a. Install MariaDB</h2>
<p>Reference: <a href="https://downloads.mariadb.org/mariadb/repositories/#mirror=digitalocean-nyc">https://downloads.mariadb.org/mariadb/repositories/#mirror=digitalocean-nyc</a></p>
<p>Reference: <a href="https://www.vultr.com/docs/install-mariadb-on-ubuntu-14-04">https://www.vultr.com/docs/install-mariadb-on-ubuntu-14-04</a></p>
<p>Get latest package.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>After running <strong>mysql_secure_installation</strong>, root will only be accessible locally.</p>
<h2 id="6b-configure-mariadb">6b. Configure MariaDB</h2>
<p>Reference: <a href="https://www.linode.com/docs/databases/mariadb/mariadb-setup-debian7">https://www.linode.com/docs/databases/mariadb/mariadb-setup-debian7</a></p>
<p>To configure:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>To enable remote connections, comment out the bind-address line:</p>
<!-- raw HTML omitted -->
<p>To connect to the database.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Users:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Reference: <a href="https://mariadb.com/kb/en/mariadb/configuring-mariadb-for-remote-client-access/">https://mariadb.com/kb/en/mariadb/configuring-mariadb-for-remote-client-access/</a></p>
<p>Reference: <a href="https://www.linode.com/docs/websites/hosting-a-website/#creating-a-database">https://www.linode.com/docs/websites/hosting-a-website/#creating-a-database</a></p>
<h2 id="6c-optimizing-mariadb">6c. Optimizing MariaDB</h2>
<p>See suggestions here for things inside <strong>my.conf</strong> you can change:</p>
<p><a href="https://www.linode.com/docs/websites/hosting-a-website/#optimizing-mysql-for-a-linode-1gb">https://www.linode.com/docs/websites/hosting-a-website/#optimizing-mysql-for-a-linode-1gb</a></p>
<p>i.e. Lower connections to 75 from 100, max_allowed_packets to 1M from 16M.</p>
<p>There is also an app that can look at logs and things and tell you what you should to to make it run better: <strong>mysqltuner</strong></p>
<p><a href="https://www.linode.com/docs/databases/mariadb/mariadb-setup-debian7#tuning-mariadb">https://www.linode.com/docs/databases/mariadb/mariadb-setup-debian7#tuning-mariadb</a></p>
<p>Your database should operate for about 24 hours under normal usage for it to make suggestions.</p>
<h2 id="6d-backups">6d. Backups</h2>
<p>Reference: <a href="http://webcheatsheet.com/sql/mysql_backup_restore.php">http://webcheatsheet.com/sql/mysql_backup_restore.php</a></p>
<p>Reference: <a href="http://dev.mysql.com/doc/refman/5.6/en/mysqldump.html">http://dev.mysql.com/doc/refman/5.6/en/mysqldump.html</a></p>
<p>A script with some nice ideas: <a href="http://www.docplanet.org/linux/backing-up-linux-web-server-live-via-ssh/">http://www.docplanet.org/linux/backing-up-linux-web-server-live-via-ssh/</a></p>
<h2 id="7-litespeed">7. Litespeed</h2>
<p>Reference: <a href="https://www.digitalocean.com/community/tutorials/how-to-install-the-openlitespeed-web-server-on-ubuntu-14-04">https://www.digitalocean.com/community/tutorials/how-to-install-the-openlitespeed-web-server-on-ubuntu-14-04</a></p>
<p>Reference: <a href="https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-with-openlitespeed-on-ubuntu-14-04">https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-with-openlitespeed-on-ubuntu-14-04</a></p>
<p>Latest version: <a href="http://open.litespeedtech.com/mediawiki/index.php/Downloads">http://open.litespeedtech.com/mediawiki/index.php/Downloads</a></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Litespeed is now installed in <strong>/usr/local/lsws</strong>.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="7b-openlitespeed-on-arm">7b. OpenLiteSpeed on ARM</h2>
<p>This is something I got working with a bit of know-how.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Now, before you build, you need to edit a file “<strong>include/ls_atomic.h</strong>“.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="8a-install-php-7">8a. Install PHP 7</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>The latest version as of this writing is <strong>PHP7.0.0RC4</strong>. The build scripts are unable to fetch the RC builds, so you can manually fetch them as follows:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Now, build PHP 7 inside the UI.</p>
<p>NOTE: php.ini may not be copied, so you can acquire the file as follows:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="8b-php-7-extensions">8b. PHP 7 Extensions</h2>
<p>To use PHPiz, you need autoconf.</p>
<!-- raw HTML omitted -->
<p><strong>GD:</strong> already installed (built-in)</p>
<p><strong>APCu (branch):</strong> <a href="https://github.com/krakjoe/apcu/tree/seven">https://github.com/krakjoe/apcu/tree/seven</a></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>Imagick (branch)</strong> or Gmagick: <a href="https://github.com/mkoppanen/imagick/tree/phpseven">https://github.com/mkoppanen/imagick/tree/phpseven</a></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="9-web-server-configuration">9. Web Server Configuration</h2>
<p>Under <strong>General-&gt;Index Files</strong>, add <strong>index.php</strong>.</p>
<p>Under <strong>External App</strong>, click <strong>Edit</strong>.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>To correctly handle CloudFlare’s IP proxying in LiteSpeed, you need to set <strong>General Settings-&gt;Use Client IP in Header</strong> to either <strong>YES</strong> or <strong>Trusted IP Only</strong>.</p>
<p>If using Trusted IPs Only, under <strong>Security-&gt;Access Control</strong>, set the <strong>Allowed List</strong> to:</p>
<!-- raw HTML omitted -->
<p>This will change the server PHP variable <strong>$_SERVER [‘REMOTE_ADDR’]</strong> from the CloudFlare IP to your IP. <strong>$_SERVER [‘PROXY_REMOTE_ADDR’]</strong> will now contain the CloudFlare IP.</p>
<p>IPs sourced from here: <a href="https://www.cloudflare.com/ips">https://www.cloudflare.com/ips</a></p>
<p>Adding a trailing T marks them as trusted.</p>
<p>Add a <strong>Listener</strong>, Port <strong>443</strong>, Secure <strong>YES</strong>. Add a <strong>Virtual Host Mapping</strong> to it.</p>
<p>Under <strong>SSL</strong>, set the <strong>Private Key File</strong> (something.key), <strong>Certificate File</strong> (something.crt), and the <strong>CA Certificate File</strong> (ca.pem). HTTPS will not work until you do this.</p>
<p>Use <strong>Listener-&gt;IP Address</strong> of <strong>[ALL] IPv6</strong> to allow incoming connections over both IPv4 and IPv6. This may require a few soft resets to kick in properly (Dashboard was reporting a listener failure for me, until I reset it).</p></div>
  
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="/2015/09/29/vps-host-notes/">← Prev Page | VPS Host Notes</a>
    <a class="next" href="/2015/10/04/openlitespeed-notes/">OpenLiteSpeed Notes | Next Page →</a>
  </nav>
</footer></main>
<footer class="footer">
  <span>&copy; 2020 <a href="https://new.toonormal.com/">TooNormal</a></span>
  <span>&middot;</span>
  <span>Powered by <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo️️</a>️</span>
</footer>
<script src="https://new.toonormal.com/highlight.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>
</body>
</html>

